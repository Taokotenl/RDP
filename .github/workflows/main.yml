name: macOS VNC Server

on:
  workflow_dispatch:

jobs:
  macos-vnc:
    runs-on: macos-latest
    timeout-minutes: 360

    steps:
      - name: Update Homebrew
        run: brew update

      - name: Cài đặt TigerVNC
        run: brew install tiger-vnc

      - name: Thiết lập mật khẩu VNC
        run: |
          mkdir -p ~/.vnc
          echo "123456" | /opt/homebrew/bin/vncpasswd -f > ~/.vnc/passwd
          chmod 600 ~/.vnc/passwd

      - name: Start VNC server
        run: |
          /opt/homebrew/bin/vncserver -geometry 1280x800 -localhost no
          echo "VNC server started on port 5901"

      - name: Giữ kết nối
        run: sleep 3600
